{"ast":null,"code":"import _toConsumableArray from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/rzt/Github/draw-table/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/rzt/Github/draw-table/src/App.js\";\nimport React, { Component } from 'react';\nimport './App.css';\nimport Header from './components/Header/Header';\nimport drawRectangles from './components/SvgUtils/drawRectangles';\nimport drawSplitLine from './components/SvgUtils/drawSplitLine';\nimport { splitOrAddRow } from './components/SvgUtils/splitOrAddRow';\nimport { generateNewTable, getTableColCords, getTableCords, getTableRowCellCords, tableData } from './components/SvgUtils/tableData';\n\nvar getRelativeSVGPoints = function getRelativeSVGPoints(e, svgElement) {\n  var pt = svgElement.createSVGPoint();\n  pt.x = e.clientX;\n  pt.y = e.clientY;\n  var hoverCoordinates = pt.matrixTransform(svgElement.getScreenCTM().inverse());\n  return hoverCoordinates;\n};\n\nvar TableAction = {\n  ADD_ROW: 'addRow',\n  ADD_COL: 'addCol'\n};\n\nvar getTableAction = function getTableAction(mode, editEntity, editAction) {\n  if (mode === 'edit' && editEntity === 'row' && editAction === 'split') {\n    return TableAction.ADD_ROW;\n  }\n\n  if (mode === 'edit' && editEntity === 'column' && editAction === 'split') {\n    return TableAction.ADD_COL;\n  }\n};\n\nvar App =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(App, _Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n    _this.state = {\n      tableData: tableData,\n      mode: 'edit',\n      // view | edit,\n      editEntity: 'row',\n      // 'cell' | 'column' | 'row' | 'table'\n      editAction: 'split',\n      // 'merge' | 'delete' | 'split'\n      selectedItems: new Set([]),\n      splitLineCoordinates: null,\n      splitAxis: 'vertical',\n      // 'horizontal', 'vertical'\n      drawnTable: {}\n    };\n    _this.handleClick = _this.handleClick.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMouseMove = _this.handleMouseMove.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleMouseOut = _this.handleMouseOut.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.selectMode = _this.selectMode.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.selectEditEntity = _this.selectEditEntity.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.selectEditAction = _this.selectEditAction.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.selectSplitAxis = _this.selectSplitAxis.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.onMouseDraw = _this.onMouseDraw.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.createNextTable = _this.createNextTable.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.drawTableRow = _this.drawTableRow.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.drawTableColumn = _this.drawTableColumn.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"drawTableColumn\",\n    value: function drawTableColumn(_ref) {\n      var e = _ref.e,\n          index = _ref.index,\n          nextData = _ref.nextData;\n      console.log('drawTableColumn', e, index, nextData);\n      e.stopPropagation();\n    }\n  }, {\n    key: \"drawTableRow\",\n    value: function drawTableRow(_ref2) {\n      var _this2 = this;\n\n      var e = _ref2.e,\n          index = _ref2.index,\n          nextData = _ref2.nextData;\n      e.stopPropagation();\n      var cords = {\n        x: e.nativeEvent.offsetX,\n        y: e.nativeEvent.offsetY\n      };\n      var newRows = splitOrAddRow({\n        cords: cords,\n        nextData: nextData,\n        tableRows: this.state.tableData.tableRows\n      });\n      this.setState({\n        tableData: _objectSpread({}, this.state.tableData, {\n          tableRows: [].concat(_toConsumableArray(this.state.tableData.tableRows), _toConsumableArray(newRows))\n        })\n      }, function () {\n        return console.log('newRows: ', newRows, _this2.state.tableData, index);\n      }); // this.setState({ tableData: { ...tableData, tableRows: [...newRows] } });\n    }\n  }, {\n    key: \"handleMouseMove\",\n    value: function handleMouseMove(e, item) {\n      var _this3 = this;\n\n      //    console.log('item ', item.id, ' hovered of type: ', item.type, ' for action: ', this.state.editAction, ' data: ', item);\n      var getLineCoordinates = function getLineCoordinates(item, hoverCoordinates, axis) {\n        var getLineCoordinatesByAxis = function getLineCoordinatesByAxis(item, hoverCoordinates, horizontalAxis) {\n          var itemWidth = item.width;\n          var itemHeight = item.height;\n\n          if (item.merged && item.colSpan > 1 && item.rowSpan > 1) {\n            itemWidth = item.mergedWidth;\n            itemHeight = item.mergedHeight;\n          }\n\n          return horizontalAxis ? {\n            x1: item.x,\n            y1: hoverCoordinates.y,\n            x2: item.x + itemWidth,\n            y2: hoverCoordinates.y\n          } : {\n            x1: hoverCoordinates.x,\n            y1: item.y,\n            x2: hoverCoordinates.x,\n            y2: item.y + itemHeight\n          };\n        };\n\n        if (item.type === 'row') {\n          return getLineCoordinatesByAxis(item, hoverCoordinates, true);\n        } else if (item.type === 'col') {\n          return getLineCoordinatesByAxis(item, hoverCoordinates, false);\n        }\n\n        return getLineCoordinatesByAxis(item, hoverCoordinates, _this3.state.splitAxis === 'horizontal');\n      };\n\n      if (this.state.mode !== 'view' && this.state.editAction === 'split') {\n        e.stopPropagation();\n        var pt = this.svgRef.createSVGPoint();\n        pt.x = e.clientX;\n        pt.y = e.clientY;\n        var hoverCoordinates = pt.matrixTransform(this.svgRef.getScreenCTM().inverse());\n        this.setState({\n          splitLineCoordinates: getLineCoordinates(item, hoverCoordinates)\n        }); // console.log({ l });\n        // console.log('item ', item.id, ' hovered of type: ', item.type, ' for action: ', this.state.editAction, e.clientX, e.clientY)\n        // const { selectedItems } = this.state;\n        // this.setState({\n        //   selectedItems: selectedItems.has(item.id) ?\n        //     (this.state.selectedItems.delete(item.id) && this.state.selectedItems) : this.state.selectedItems.add(item.id),\n        // })\n      } else {// highlightTableData();\n        }\n    }\n  }, {\n    key: \"handleClick\",\n    value: function handleClick(_ref3) {\n      var e = _ref3.e,\n          index = _ref3.index,\n          nextData = _ref3.nextData;\n      var _this$state = this.state,\n          mode = _this$state.mode,\n          editEntity = _this$state.editEntity,\n          editAction = _this$state.editAction;\n      var actionType = getTableAction(mode, editEntity, editAction);\n\n      switch (actionType) {\n        case TableAction.ADD_ROW:\n          this.drawTableRow({\n            e: e,\n            index: index,\n            nextData: nextData\n          });\n          break;\n\n        case TableAction.ADD_COL:\n          this.drawTableColumn({\n            e: e,\n            index: index,\n            nextData: nextData\n          });\n          break;\n\n        default:\n          break;\n      }\n    }\n  }, {\n    key: \"handleMouseOut\",\n    value: function handleMouseOut(e, item) {\n      this.setState({\n        splitLineCoordinates: null\n      });\n    }\n  }, {\n    key: \"selectMode\",\n    value: function selectMode(e) {\n      this.setState({\n        mode: e.target.value,\n        selectedItems: new Set([])\n      });\n    }\n  }, {\n    key: \"selectEditEntity\",\n    value: function selectEditEntity(e) {\n      this.setState({\n        editEntity: e.target.value,\n        selectedItems: new Set([])\n      });\n    }\n  }, {\n    key: \"selectEditAction\",\n    value: function selectEditAction(e) {\n      this.setState({\n        editAction: e.target.value,\n        selectedItems: new Set([])\n      });\n    }\n  }, {\n    key: \"selectSplitAxis\",\n    value: function selectSplitAxis(e) {\n      this.setState({\n        splitAxis: e.target.value\n      });\n    }\n  }, {\n    key: \"onMouseDraw\",\n    value: function onMouseDraw(e) {\n      var p = getRelativeSVGPoints(e, this.tableDrawCanvasSvg);\n      console.log('mousemove p:', p);\n      this.setState({\n        drawnTable: _objectSpread({}, this.state.drawnTable, {\n          x2: p.x,\n          y2: p.y\n        })\n      });\n    }\n  }, {\n    key: \"createNextTable\",\n    value: function createNextTable(e) {\n      var getCoordinates = function getCoordinates(_ref4) {\n        var x1 = _ref4.x1,\n            y1 = _ref4.y1,\n            x2 = _ref4.x2,\n            y2 = _ref4.y2;\n        return {\n          x: Math.min(x1, x2),\n          y: Math.min(y1, y2),\n          width: Math.abs(x2 - x1),\n          height: Math.abs(y2 - y1)\n        };\n      };\n\n      var tableObj = {\n        type: 'table',\n        coordinates: getCoordinates(this.state.drawnTable)\n      };\n      console.log('tableObj: ', tableObj);\n      var newTableData = generateNewTable(tableObj.coordinates);\n      this.setState({\n        tableData: newTableData\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var _this$state2 = this.state,\n          mode = _this$state2.mode,\n          editEntity = _this$state2.editEntity,\n          editAction = _this$state2.editAction,\n          selectedItems = _this$state2.selectedItems,\n          splitLineCoordinates = _this$state2.splitLineCoordinates;\n\n      var applyHiddenClassName = function applyHiddenClassName(entityName) {\n        return mode === 'edit' && editEntity !== entityName ? 'noDisplay' : '';\n      };\n\n      var tableClassNames = applyHiddenClassName('table');\n      var tableRowClassNames = mode === 'view' ? 'noDisplay' : applyHiddenClassName('row');\n      var tableColumnClassNames = mode === 'view' ? 'noDisplay' : applyHiddenClassName('column');\n      var tableCellClassNames = applyHiddenClassName('cell');\n      var showSplitAxisDropDown = mode === 'edit' && (editAction === 'split' || editAction === 'split') && (editEntity === 'table' || editEntity === 'cell');\n      var tableRowCellCords = getTableRowCellCords(this.state.tableData);\n      var entityCoordinatesList = [{\n        coordinates: getTableCords(this.state.tableData),\n        className: tableClassNames,\n        type: 'table'\n      }, {\n        coordinates: tableRowCellCords.tableRowCords,\n        type: 'row',\n        className: tableRowClassNames\n      }, {\n        coordinates: getTableColCords(this.state.tableData),\n        type: 'col',\n        className: tableColumnClassNames\n      }, {\n        coordinates: tableRowCellCords.tableCellCords,\n        type: 'cell',\n        className: tableCellClassNames\n      }];\n      var tableFigure = entityCoordinatesList.map(function (entityCoordinates) {\n        return drawRectangles(entityCoordinates.coordinates, entityCoordinates.className, selectedItems, _this4.handleClick, _this4.handleMouseMove, _this4.handleMouseOut);\n      }); //    console.log('width: ', this.state.drawnTable.x2 - this.state.drawnTable.x1);\n      //    console.log('height: ', this.state.drawnTable.y2 - this.state.drawnTable.y1);\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(Header, {\n        modeValue: this.state.mode,\n        onModeChange: this.selectMode,\n        editValue: this.state.editEntity,\n        onEditChange: this.selectEditEntity,\n        actionValue: this.state.editAction,\n        onActionChange: this.selectEditAction,\n        showAxisInput: showSplitAxisDropDown,\n        axisValue: this.state.splitAxis,\n        onAxisChange: this.selectSplitAxis,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"App-content\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"presentation-area\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277\n        },\n        __self: this\n      }, React.createElement(\"svg\", {\n        ref: function ref(r) {\n          return _this4.svgRef = r;\n        },\n        width: \"100%\",\n        height: \"100%\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }, tableFigure, splitLineCoordinates && drawSplitLine(splitLineCoordinates))), React.createElement(\"div\", {\n        className: \"canvas-area\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }, React.createElement(\"svg\", {\n        ref: function ref(r) {\n          return _this4.tableDrawCanvasSvg = r;\n        },\n        width: \"100%\",\n        height: \"100%\",\n        style: {\n          background: 'white',\n          cursor: 'crosshair'\n        },\n        onMouseDown: function onMouseDown(e) {\n          var p = getRelativeSVGPoints(e, _this4.tableDrawCanvasSvg);\n          console.log({\n            p: p\n          });\n\n          _this4.setState({\n            drawnTable: {\n              x1: p.x,\n              y1: p.y\n            }\n          });\n\n          _this4.tableDrawCanvasSvg.addEventListener('mousemove', _this4.onMouseDraw);\n        },\n        onMouseUp: function onMouseUp() {\n          _this4.tableDrawCanvasSvg.removeEventListener('mousemove', _this4.onMouseDraw);\n        } // onMouseDown={() => {\n        //   const nextTableIndex = this.state.drawnTables.count();\n        //\n        // }}\n        // onMouseUp={}\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 287\n        },\n        __self: this\n      }, this.state.drawnTable.x1 && this.state.drawnTable.x2 && React.createElement(\"rect\", {\n        x: Math.min(this.state.drawnTable.x1, this.state.drawnTable.x2),\n        y: Math.min(this.state.drawnTable.y1, this.state.drawnTable.y2),\n        width: Math.abs(this.state.drawnTable.x2 - this.state.drawnTable.x1),\n        height: Math.abs(this.state.drawnTable.y2 - this.state.drawnTable.y1),\n        fill: \"transparent\",\n        stroke: \"black\" // className={className}\n        // onClick={onClick}\n        // onMouseMove={onMouseMove}\n        // onMouseOut={onMouseOut}\n        // fillOpacity={fillOpacity}\n        ,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315\n        },\n        __self: this\n      })))), React.createElement(\"div\", {\n        className: \"footer\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 332\n        },\n        __self: this\n      }, this.state.drawnTable.x1 && this.state.drawnTable.x2 && React.createElement(\"button\", {\n        className: \"footer-btn\",\n        onClick: this.createNextTable,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      }, \"Create Table\")));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nexport default App;","map":{"version":3,"sources":["/Users/rzt/Github/draw-table/src/App.js"],"names":["React","Component","Header","drawRectangles","drawSplitLine","splitOrAddRow","generateNewTable","getTableColCords","getTableCords","getTableRowCellCords","tableData","getRelativeSVGPoints","e","svgElement","pt","createSVGPoint","x","clientX","y","clientY","hoverCoordinates","matrixTransform","getScreenCTM","inverse","TableAction","ADD_ROW","ADD_COL","getTableAction","mode","editEntity","editAction","App","props","state","selectedItems","Set","splitLineCoordinates","splitAxis","drawnTable","handleClick","bind","handleMouseMove","handleMouseOut","selectMode","selectEditEntity","selectEditAction","selectSplitAxis","onMouseDraw","createNextTable","drawTableRow","drawTableColumn","index","nextData","console","log","stopPropagation","cords","nativeEvent","offsetX","offsetY","newRows","tableRows","setState","item","getLineCoordinates","axis","getLineCoordinatesByAxis","horizontalAxis","itemWidth","width","itemHeight","height","merged","colSpan","rowSpan","mergedWidth","mergedHeight","x1","y1","x2","y2","type","svgRef","actionType","target","value","p","tableDrawCanvasSvg","getCoordinates","Math","min","abs","tableObj","coordinates","newTableData","applyHiddenClassName","entityName","tableClassNames","tableRowClassNames","tableColumnClassNames","tableCellClassNames","showSplitAxisDropDown","tableRowCellCords","entityCoordinatesList","className","tableRowCords","tableCellCords","tableFigure","map","entityCoordinates","r","background","cursor","addEventListener","removeEventListener"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport Header from './components/Header/Header';\nimport drawRectangles from './components/SvgUtils/drawRectangles';\nimport drawSplitLine from './components/SvgUtils/drawSplitLine';\nimport { splitOrAddRow } from './components/SvgUtils/splitOrAddRow';\nimport {\n  generateNewTable,\n  getTableColCords,\n  getTableCords,\n  getTableRowCellCords,\n  tableData,\n} from './components/SvgUtils/tableData';\n\nconst getRelativeSVGPoints = (e, svgElement) => {\n  let pt = svgElement.createSVGPoint();\n  pt.x = e.clientX;\n  pt.y = e.clientY;\n  const hoverCoordinates = pt.matrixTransform(svgElement.getScreenCTM().inverse());\n  return hoverCoordinates;\n};\n\nconst TableAction = {\n  ADD_ROW: 'addRow',\n  ADD_COL: 'addCol',\n};\n\nconst getTableAction = (mode, editEntity, editAction) => {\n  if (mode === 'edit' && editEntity === 'row' && editAction === 'split') {\n    return TableAction.ADD_ROW;\n  }\n  if (mode === 'edit' && editEntity === 'column' && editAction === 'split') {\n    return TableAction.ADD_COL;\n  }\n};\n\nclass App extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      tableData: tableData,\n      mode: 'edit', // view | edit,\n      editEntity: 'row', // 'cell' | 'column' | 'row' | 'table'\n      editAction: 'split', // 'merge' | 'delete' | 'split'\n      selectedItems: new Set([]),\n      splitLineCoordinates: null,\n      splitAxis: 'vertical', // 'horizontal', 'vertical'\n      drawnTable: {},\n    };\n    this.handleClick = this.handleClick.bind(this);\n    this.handleMouseMove = this.handleMouseMove.bind(this);\n    this.handleMouseOut = this.handleMouseOut.bind(this);\n    this.selectMode = this.selectMode.bind(this);\n    this.selectEditEntity = this.selectEditEntity.bind(this);\n    this.selectEditAction = this.selectEditAction.bind(this);\n    this.selectSplitAxis = this.selectSplitAxis.bind(this);\n    this.onMouseDraw = this.onMouseDraw.bind(this);\n    this.createNextTable = this.createNextTable.bind(this);\n    this.drawTableRow = this.drawTableRow.bind(this);\n    this.drawTableColumn = this.drawTableColumn.bind(this);\n  }\n\n  drawTableColumn({ e, index, nextData }) {\n    console.log('drawTableColumn', e, index, nextData);\n    e.stopPropagation();\n  }\n\n  drawTableRow({ e, index, nextData }) {\n    e.stopPropagation();\n    const cords = { x: e.nativeEvent.offsetX, y: e.nativeEvent.offsetY };\n    const newRows = splitOrAddRow({ cords, nextData, tableRows: this.state.tableData.tableRows });\n    this.setState({\n      tableData: {\n        ...this.state.tableData,\n        tableRows: [\n          ...this.state.tableData.tableRows,\n          ...newRows,\n        ],\n      },\n    }, () => console.log('newRows: ', newRows, this.state.tableData, index));\n    // this.setState({ tableData: { ...tableData, tableRows: [...newRows] } });\n  }\n\n  handleMouseMove(e, item) {\n//    console.log('item ', item.id, ' hovered of type: ', item.type, ' for action: ', this.state.editAction, ' data: ', item);\n    const getLineCoordinates = (item, hoverCoordinates, axis) => {\n      const getLineCoordinatesByAxis = (item, hoverCoordinates, horizontalAxis) => {\n        let itemWidth = item.width;\n        let itemHeight = item.height;\n        if (item.merged && (item.colSpan > 1 && item.rowSpan > 1)) {\n          itemWidth = item.mergedWidth;\n          itemHeight = item.mergedHeight;\n        }\n        return (\n          horizontalAxis ? ({\n            x1: item.x,\n            y1: hoverCoordinates.y,\n            x2: item.x + itemWidth,\n            y2: hoverCoordinates.y,\n          }) : ({\n            x1: hoverCoordinates.x,\n            y1: item.y,\n            x2: hoverCoordinates.x,\n            y2: item.y + itemHeight,\n          })\n        );\n      };\n      if (item.type === 'row') {\n        return getLineCoordinatesByAxis(item, hoverCoordinates, true);\n      } else if (item.type === 'col') {\n        return getLineCoordinatesByAxis(item, hoverCoordinates, false);\n      }\n      return getLineCoordinatesByAxis(item, hoverCoordinates, this.state.splitAxis === 'horizontal');\n    };\n\n    if (this.state.mode !== 'view' && this.state.editAction === 'split') {\n      e.stopPropagation();\n      let pt = this.svgRef.createSVGPoint();\n      pt.x = e.clientX;\n      pt.y = e.clientY;\n      const hoverCoordinates = pt.matrixTransform(this.svgRef.getScreenCTM().inverse());\n      this.setState({\n        splitLineCoordinates: getLineCoordinates(item, hoverCoordinates),\n      });\n      // console.log({ l });\n      // console.log('item ', item.id, ' hovered of type: ', item.type, ' for action: ', this.state.editAction, e.clientX, e.clientY)\n      // const { selectedItems } = this.state;\n      // this.setState({\n      //   selectedItems: selectedItems.has(item.id) ?\n      //     (this.state.selectedItems.delete(item.id) && this.state.selectedItems) : this.state.selectedItems.add(item.id),\n      // })\n    } else {\n      // highlightTableData();\n    }\n  }\n\n  handleClick({ e, index, nextData }) {\n    const { mode, editEntity, editAction } = this.state;\n    const actionType = getTableAction(mode, editEntity, editAction);\n\n    switch (actionType) {\n      case TableAction.ADD_ROW :\n        this.drawTableRow({ e, index, nextData });\n        break;\n      case TableAction.ADD_COL :\n        this.drawTableColumn({ e, index, nextData });\n        break;\n      default:\n        break;\n    }\n  }\n\n  handleMouseOut(e, item) {\n    this.setState({ splitLineCoordinates: null });\n  }\n\n  selectMode(e) {\n    this.setState({\n      mode: e.target.value,\n      selectedItems: new Set([]),\n    });\n  }\n\n  selectEditEntity(e) {\n    this.setState({\n      editEntity: e.target.value,\n      selectedItems: new Set([]),\n    });\n  }\n\n  selectEditAction(e) {\n    this.setState({\n      editAction: e.target.value,\n      selectedItems: new Set([]),\n    });\n  }\n\n  selectSplitAxis(e) {\n    this.setState({\n      splitAxis: e.target.value,\n    });\n  }\n\n  onMouseDraw(e) {\n    const p = getRelativeSVGPoints(e, this.tableDrawCanvasSvg);\n    console.log('mousemove p:', p);\n    this.setState({\n      drawnTable: {\n        ...this.state.drawnTable,\n        x2: p.x,\n        y2: p.y,\n      },\n    });\n  }\n\n  createNextTable(e) {\n    const getCoordinates = ({ x1, y1, x2, y2 }) => ({\n      x: Math.min(x1, x2),\n      y: Math.min(y1, y2),\n      width: Math.abs(x2 - x1),\n      height: Math.abs(y2 - y1),\n    });\n    const tableObj = {\n      type: 'table',\n      coordinates: getCoordinates(this.state.drawnTable),\n    };\n    console.log('tableObj: ', tableObj);\n    const newTableData = generateNewTable(tableObj.coordinates);\n    this.setState({ tableData: newTableData });\n  }\n\n  render() {\n    const { mode, editEntity, editAction, selectedItems, splitLineCoordinates } = this.state;\n    const applyHiddenClassName = (entityName) => mode === 'edit' && editEntity !== entityName ? 'noDisplay' : '';\n\n    const tableClassNames = applyHiddenClassName('table');\n    const tableRowClassNames = mode === 'view' ? 'noDisplay' : applyHiddenClassName('row');\n    const tableColumnClassNames = mode === 'view' ? 'noDisplay' : applyHiddenClassName('column');\n    const tableCellClassNames = applyHiddenClassName('cell');\n    const showSplitAxisDropDown = (mode === 'edit')\n      && (editAction === 'split' || editAction === 'split')\n      && (editEntity === 'table' || editEntity === 'cell');\n\n    const tableRowCellCords = getTableRowCellCords(this.state.tableData);\n\n    const entityCoordinatesList = [\n      {\n        coordinates: getTableCords(this.state.tableData),\n        className: tableClassNames,\n        type: 'table',\n      },\n      {\n        coordinates: tableRowCellCords.tableRowCords,\n        type: 'row',\n        className: tableRowClassNames,\n\n      },\n      {\n        coordinates: getTableColCords(this.state.tableData),\n        type: 'col',\n        className: tableColumnClassNames,\n      },\n      {\n        coordinates: tableRowCellCords.tableCellCords,\n        type: 'cell',\n        className: tableCellClassNames,\n      },\n    ];\n\n    const tableFigure = entityCoordinatesList.map(entityCoordinates => drawRectangles(\n      entityCoordinates.coordinates,\n      entityCoordinates.className,\n      selectedItems,\n      this.handleClick,\n      this.handleMouseMove,\n      this.handleMouseOut,\n    ));\n\n//    console.log('width: ', this.state.drawnTable.x2 - this.state.drawnTable.x1);\n//    console.log('height: ', this.state.drawnTable.y2 - this.state.drawnTable.y1);\n\n    return (\n      <div className=\"App\">\n        <Header\n          modeValue={this.state.mode}\n          onModeChange={this.selectMode}\n          editValue={this.state.editEntity}\n          onEditChange={this.selectEditEntity}\n          actionValue={this.state.editAction}\n          onActionChange={this.selectEditAction}\n          showAxisInput={showSplitAxisDropDown}\n          axisValue={this.state.splitAxis}\n          onAxisChange={this.selectSplitAxis}\n        />\n        <div className=\"App-content\">\n          <div className=\"presentation-area\">\n            <svg\n              ref={r => this.svgRef = r}\n              width=\"100%\"\n              height=\"100%\">\n              {tableFigure}\n              {splitLineCoordinates && drawSplitLine(splitLineCoordinates)}\n            </svg>\n          </div>\n          <div className=\"canvas-area\">\n            <svg\n              ref={r => this.tableDrawCanvasSvg = r}\n              width=\"100%\"\n              height=\"100%\"\n              style={{ background: 'white', cursor: 'crosshair' }}\n              onMouseDown={(e) => {\n                const p = getRelativeSVGPoints(e, this.tableDrawCanvasSvg);\n                console.log({ p });\n                this.setState({\n                  drawnTable: {\n                    x1: p.x,\n                    y1: p.y,\n                  },\n                });\n                this.tableDrawCanvasSvg.addEventListener('mousemove', this.onMouseDraw);\n              }}\n              onMouseUp={() => {\n                this.tableDrawCanvasSvg.removeEventListener('mousemove', this.onMouseDraw);\n              }}\n              // onMouseDown={() => {\n              //   const nextTableIndex = this.state.drawnTables.count();\n              //\n              // }}\n              // onMouseUp={}\n            >\n              {\n                this.state.drawnTable.x1 &&\n                this.state.drawnTable.x2 &&\n                <rect\n                  x={Math.min(this.state.drawnTable.x1, this.state.drawnTable.x2)}\n                  y={Math.min(this.state.drawnTable.y1, this.state.drawnTable.y2)}\n                  width={Math.abs(this.state.drawnTable.x2 - this.state.drawnTable.x1)}\n                  height={Math.abs(this.state.drawnTable.y2 - this.state.drawnTable.y1)}\n                  fill=\"transparent\"\n                  stroke=\"black\"\n                  // className={className}\n                  // onClick={onClick}\n                  // onMouseMove={onMouseMove}\n                  // onMouseOut={onMouseOut}\n                  // fillOpacity={fillOpacity}\n                />\n              }\n            </svg>\n          </div>\n        </div>\n        <div className=\"footer\">\n          {this.state.drawnTable.x1 && this.state.drawnTable.x2 &&\n          <button className=\"footer-btn\" onClick={this.createNextTable}>\n            Create Table\n          </button>}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}